{% extends "base.html" %}

{% block content %}
<article class="card">
    <header>
        <h1>{{ content.title }}</h1>
        <div class="meta" style="margin-top: 15px; color: var(--text-secondary);">
            <span>📅 {{ content.processed_time | format_date }}</span>
            <span style="margin-left: 20px;">🎵 {{ content.original_file }}</span>
            {% if content.file_size %}
            <span style="margin-left: 20px;">📦 {{ content.file_size | file_size }}</span>
            {% endif %}
            {% if content.audio_duration %}
            <span style="margin-left: 20px;">⏱️ {{ content.audio_duration }}</span>
            {% endif %}
        </div>
    </header>
    
    <div style="margin-top: 30px;">
        <section class="summary">
            <h2>📄 内容摘要</h2>
            <div style="margin-top: 15px; padding: 20px; background-color: var(--card-bg); border-radius: 8px;">
                {{ content.summary | markdown | safe }}
            </div>
        </section>
        
        <section class="mindmap" style="margin-top: 30px;">
            <h2>🧠 思维导图</h2>
            <div style="margin-top: 15px; padding: 20px; background-color: var(--card-bg); border-radius: 8px;">
                {{ content.mindmap | markdown | safe }}
            </div>
        </section>
        
        {% if content.anonymized_names and content.anonymized_names | length > 0 %}
        <section class="anonymization" style="margin-top: 30px;">
            <h2>🔒 人名匿名化</h2>
            <div style="margin-top: 15px;">
                <p>本次处理中共匿名化了 <strong>{{ content.anonymized_names | length }}</strong> 个人名：</p>
                
                <table class="table table-striped" style="margin-top: 15px;">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>匿名化后</th>
                            <th>类型</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for original, anonymous in content.anonymized_names.items() %}
                        <tr>
                            <td>{{ loop.index }}</td>
                            <td>{{ anonymous }}</td>
                            <td>中文/英文</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                
                <p style="margin-top: 15px; font-style: italic; color: var(--text-secondary);">
                    💡 为保护隐私，所有人名已被替换为虚拟姓名
                </p>
            </div>
        </section>
        {% endif %}
        
        {% if content.statistics %}
        <section class="statistics" style="margin-top: 30px;">
            <h2>📊 处理统计</h2>
            <table class="table table-striped" style="margin-top: 15px;">
                <tbody>
                    <tr>
                        <td>摘要长度</td>
                        <td>{{ content.summary | length }} 字符</td>
                    </tr>
                    <tr>
                        <td>思维导图长度</td>
                        <td>{{ content.mindmap | length }} 字符</td>
                    </tr>
                    <tr>
                        <td>匿名化人名数</td>
                        <td>{{ content.anonymized_names | length }} 个</td>
                    </tr>
                    {% if content.processing_duration %}
                    <tr>
                        <td>处理时长</td>
                        <td>{{ content.processing_duration }}</td>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </section>
        {% endif %}
    </div>
</article>

<!-- 返回按钮 -->
<div style="margin-top: 30px; text-align: center;">
    <a href="index.html" class="btn btn-primary">🔙 返回首页</a>
</div>
{% endblock %}