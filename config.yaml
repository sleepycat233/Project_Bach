
paths:
  data_folder: "./data"  # æ•°æ®å­˜å‚¨ç›®å½• (è½¬å½•æ–‡æœ¬ã€æ—¥å¿—ç­‰)
  watch_folder: "./data/uploads"  # éŸ³é¢‘æ–‡ä»¶ç›‘æ§ç›®å½• - ç›´æ¥ç›‘æ§ä¸Šä¼ ç›®å½•
  output_folder: "./data/output"  # å¤„ç†ç»“æœè¾“å‡ºç›®å½•

spacy:
  model: "zh_core_web_sm"

# ç³»ç»Ÿé…ç½®
system:
  debug: false  # è°ƒè¯•æ¨¡å¼å¼€å…³

logging:
  level: "INFO"  # æ—¥å¿—çº§åˆ«: DEBUG, INFO, WARNING, ERROR, CRITICAL
  file: "./data/logs/app.log"
  console: true  # æ˜¯å¦åœ¨æ§åˆ¶å°è¾“å‡ºæ—¥å¿—


# OpenRouter APIé…ç½® (ç”¨äºAIå†…å®¹ç”Ÿæˆ)
# API key é€šè¿‡ç¯å¢ƒå˜é‡ OPENROUTER_API_KEY æä¾›
openrouter:
  base_url: "https://openrouter.ai/api/v1"
  models:
    summary: "google/gemma-3n-e4b-it:free"  # Googleå…è´¹å¿«é€Ÿæ¨¡å‹
    mindmap: "google/gemma-3n-e4b-it:free"  # Googleå…è´¹å¿«é€Ÿæ¨¡å‹
    # å¤‡é€‰å…è´¹å¿«é€Ÿæ¨¡å‹ï¼š

  rate_limit_tier: "paid"  # é€‰é¡¹: "free" æˆ– "paid"
  # Free tier: 10 req/10s, 60 req/min, 5 credits/day
  # Paid tier: 10 req/10s, 60 req/min, æŒ‰creditè®¡è´¹

# Phase 10: MLX Whisperé…ç½® (æ›¿ä»£WhisperKit)
mlx_whisper:
  # é»˜è®¤æ¨¡å‹é…ç½® - ä½¿ç”¨æ ‡å‡†MLXå‘½å
  default_model: "whisper-tiny-mlx"  # é»˜è®¤ä½¿ç”¨çš„æ¨¡å‹

  # å¯ç”¨æ¨¡å‹åˆ—è¡¨ï¼ˆç»Ÿä¸€ä½¿ç”¨æ ‡å‡†MLXå‘½åï¼‰
  available_models:
    - "mlx-community/whisper-tiny-mlx"
    - "mlx-community/whisper-base-mlx"
    - "mlx-community/whisper-small-mlx"
    - "mlx-community/whisper-medium-mlx"
    - "mlx-community/whisper-large-v3-mlx"
    - "mlx-community/whisper-large-v3-turbo"

# Speaker Diarizationé…ç½®
diarization:
  provider: "pyannote"   # ä½¿ç”¨pyannote-audioï¼Œä»HuggingFaceç¼“å­˜åŠ è½½
  max_speakers: 6
  min_segment_duration: 1.0

  # pyannote.audio pipelineå‚æ•°é…ç½® (ä¸¥æ ¼å‚æ•°ï¼Œå‡å°‘è¯¯æ£€)
  # åŸºäºPhase 11è°ƒè¯•ç»“æœä¼˜åŒ–çš„ä¸¥æ ¼é…ç½®
  pipeline_params:
    segmentation:
      min_duration_off: 1.0          # æœ€å°é™éŸ³æ—¶é•¿(ç§’) - æ›´ä¸¥æ ¼ï¼Œå‡å°‘çŸ­æ’è¯è¯¯æ£€
    clustering:
      method: "centroid"             # èšç±»æ–¹æ³•
      min_cluster_size: 20           # æœ€å°èšç±»å¤§å° - æ›´å¤§å€¼ï¼Œå‡å°‘è™šå‡è¯´è¯äºº
      threshold: 0.9                 # èšç±»é˜ˆå€¼ - æ›´é«˜å€¼ï¼Œé™ä½æ•æ„Ÿåº¦

  # è¾“å‡ºæ ¼å¼é…ç½®
  output_format:
    group_by_speaker: true          # é»˜è®¤æŒ‰è¯´è¯äººåˆ†ç»„ï¼Œä¾¿äºé˜…è¯»
    timestamp_precision: 1          # æ—¶é—´æˆ³ç²¾åº¦(å°æ•°ä½æ•°)
    include_confidence: false       # æ˜¯å¦åŒ…å«ç½®ä¿¡åº¦ä¿¡æ¯


# Phase 6: å¤šåª’ä½“å†…å®¹åˆ†ç±»ä¸Webç•Œé¢é…ç½®
content_classification:
  # æ”¯æŒçš„å†…å®¹ç±»å‹å®šä¹‰
  content_types:
    lecture:      # ğŸ“ å­¦æœ¯è®²åº§
      icon: "ğŸ“"
      display_name: "Academic Lecture"
      diarization_default: false  # è®²åº§é€šå¸¸å•äººï¼Œé»˜è®¤ä¸å¯ç”¨
      subcategories:
        CS101:
          display_name: "CS101-Computer Science Course"
          diarization: false  # CSè¯¾ç¨‹ï¼Œå•äººè®²æˆ
        PHYS101:
          display_name: "PHYS101-Physics Course"
          diarization: false  # ç‰©ç†è¯¾ç¨‹ï¼Œå•äººè®²æˆ
        Seminar:
          display_name: "Academic Seminar"
          diarization: true   # ç ”è®¨ä¼šï¼Œå¯èƒ½æœ‰è®¨è®ºç¯èŠ‚
      recommendations:
        english:
          - "whisper-base-mlx"
          - "whisper-small-mlx"  # è‹±æ–‡å¿«é€Ÿæ¨¡å‹
        multilingual:
          - "whisper-large-v3-mlx"         # å¤šè¯­è¨€é«˜ç²¾åº¦

    meeting:      # ğŸ¢ ä¼šè®®å½•éŸ³
      icon: "ğŸ¢"
      display_name: "Meeting Recording"
      diarization_default: true   # ä¼šè®®å¤šäººå¯¹è¯ï¼Œé»˜è®¤å¯ç”¨
      subcategories:
        team_meeting:
          display_name: "Team Meeting"
          diarization: true   # å›¢é˜Ÿä¼šè®®ï¼Œå¤šäººå‚ä¸
        project_review:
          display_name: "Project Review"
          diarization: true   # è¯„å®¡ä¼šè®®ï¼Œå¤šäººè®¨è®º
        client_call:
          display_name: "Client Call"
          diarization: true   # å®¢æˆ·ç”µè¯ï¼ŒåŒäººå¯¹è¯
        standup:
          display_name: "Daily Standup"
          diarization: true   # ç«™ä¼šï¼Œå¤šäººå‚ä¸
      recommendations:
        english:
          - "whisper-base-mlx"                     # MLXè‹±æ–‡å¤„ç†
        multilingual:
          - "whisper-large-v3-mlx"                 # MLXå¤šè¯­è¨€å¤„ç†


# Phase 6: Webå‰ç«¯é…ç½®
web_frontend:
  # Flaskåº”ç”¨é…ç½®
  # Flaskå¯†é’¥é€šè¿‡ç¯å¢ƒå˜é‡ FLASK_SECRET_KEY æä¾›
  app:
    host: "0.0.0.0"              # ç›‘å¬åœ°å€ (Tailscaleç½‘ç»œå†…)
    port: 8080                   # æœåŠ¡ç«¯å£
    debug: false                 # è°ƒè¯•æ¨¡å¼

  # æ–‡ä»¶ä¸Šä¼ é…ç½®
  upload:
    max_file_size: 524288000     # 500MB (500 * 1024 * 1024)
    supported_formats: [".mp3", ".wav", ".m4a", ".mp4", ".flac", ".aac", ".ogg", ".wma"]

  # å®‰å…¨é…ç½®
  security:
    tailscale_only: true         # ä»…å…è®¸Tailscaleç½‘ç»œè®¿é—®
    rate_limit_per_minute: 60    # æ¯åˆ†é’Ÿè¯·æ±‚é™åˆ¶
    rate_limit_per_hour: 1000    # æ¯å°æ—¶è¯·æ±‚é™åˆ¶
    enable_csrf: true            # å¯ç”¨CSRFä¿æŠ¤
    session_timeout: 3600        # ä¼šè¯è¶…æ—¶(ç§’)

  # UIé…ç½®
  ui:
    theme: "dark"                # é»˜è®¤ä¸»é¢˜
    language: "zh-CN"            # é»˜è®¤è¯­è¨€

# Phase 4: ç½‘ç»œé›†æˆé…ç½®
# Tailscaleè®¤è¯å¯†é’¥é€šè¿‡ç¯å¢ƒå˜é‡ TAILSCALE_AUTH_KEY æä¾›
network:
  tailscale:
    machine_name: "project-bach"  # æœºå™¨åç§°
    network_name: "project-bach-network"  # ç½‘ç»œåç§°
    auto_connect: true  # è‡ªåŠ¨è¿æ¥
    timeout: 30  # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰

  file_transfer:
    remote_base_path: "/Users/remote/project_bach/watch_folder"  # è¿œç¨‹ç›‘æ§æ–‡ä»¶å¤¹è·¯å¾„
    local_base_path: "./watch_folder"  # æœ¬åœ°ç›‘æ§æ–‡ä»¶å¤¹è·¯å¾„
    chunk_size: 8192  # æ–‡ä»¶ä¼ è¾“å—å¤§å°ï¼ˆå­—èŠ‚ï¼‰
    timeout: 60  # ä¼ è¾“è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    retry_attempts: 3  # é‡è¯•æ¬¡æ•°
    verify_integrity: true  # æ˜¯å¦éªŒè¯æ–‡ä»¶å®Œæ•´æ€§
    max_file_size: 104857600  # æœ€å¤§æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆ100MBï¼‰

  security:
    allowed_networks: ["100.64.0.0/10"]  # Tailscale CGNATèŒƒå›´
    blocked_ips: []  # é˜»æ­¢çš„IPåœ°å€åˆ—è¡¨
    require_encryption: true  # æ˜¯å¦è¦æ±‚åŠ å¯†è¿æ¥
    max_connection_attempts: 3  # æœ€å¤§è¿æ¥å°è¯•æ¬¡æ•°
    connection_timeout: 10  # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    max_connections_per_minute: 60  # æ¯åˆ†é’Ÿæœ€å¤§è¿æ¥æ•°
    connection_window_seconds: 60  # è¿æ¥é¢‘ç‡ç»Ÿè®¡çª—å£ï¼ˆç§’ï¼‰

  monitoring:
    check_interval: 30  # ç½‘ç»œçŠ¶æ€æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
    timeout: 5  # pingè¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    max_retries: 3  # æœ€å¤§é‡è¯•æ¬¡æ•°
    target_hosts: []  # ç›‘æ§ç›®æ ‡ä¸»æœºåˆ—è¡¨ï¼Œå¯åŠ¨æ—¶è‡ªåŠ¨å‘ç°TailscaleèŠ‚ç‚¹
    alert_on_disconnect: true  # è¿æ¥æ–­å¼€æ—¶æ˜¯å¦å‘Šè­¦

  # å®‰å…¨æ–‡ä»¶æœåŠ¡å™¨é…ç½®
  # è®¤è¯tokené€šè¿‡ç¯å¢ƒå˜é‡ SECURE_FILE_SERVER_TOKEN æä¾›
  secure_file_server:
    enabled: true  # æ˜¯å¦å¯ç”¨å®‰å…¨æ–‡ä»¶æœåŠ¡å™¨
    host: "0.0.0.0"  # ç›‘å¬åœ°å€ï¼Œ0.0.0.0è¡¨ç¤ºæ‰€æœ‰æ¥å£
    port: 8080  # æœåŠ¡ç«¯å£
    allowed_dirs:  # åªå…è®¸è®¿é—®è¿™äº›ç›®å½•
      - "./watch_folder"
      - "./output"
    enable_upload: true  # æ˜¯å¦å…è®¸æ–‡ä»¶ä¸Šä¼ 
    enable_download: true  # æ˜¯å¦å…è®¸æ–‡ä»¶ä¸‹è½½

# YouTubeå¤„ç†å™¨é…ç½®
youtube:
  # yt-dlpé…ç½®
  downloader:
    max_duration: 7200           # æœ€å¤§æ—¶é•¿(ç§’) 2å°æ—¶
    min_duration: 60             # æœ€å°æ—¶é•¿(ç§’) 1åˆ†é’Ÿ
    preferred_quality: "best[height<=720]"  # é¦–é€‰è´¨é‡
    extract_audio_only: true     # ä»…æå–éŸ³é¢‘
    output_format: "mp3"         # è¾“å‡ºæ ¼å¼
    output_dir: "./temp/youtube" # è¾“å‡ºç›®å½•
    timeout: 600                 # ä¸‹è½½è¶…æ—¶(ç§’)

  # å†…å®¹éªŒè¯
  validation:
    check_availability: true     # æ£€æŸ¥è§†é¢‘å¯ç”¨æ€§
    validate_duration: true      # éªŒè¯æ—¶é•¿
    skip_private: true           # è·³è¿‡ç§æœ‰è§†é¢‘
    skip_age_restricted: false   # è·³è¿‡å¹´é¾„é™åˆ¶è§†é¢‘

  # å…ƒæ•°æ®æå–
  metadata:
    extract_thumbnail: true      # æå–ç¼©ç•¥å›¾
    extract_description: true    # æå–æè¿°
    extract_tags: true           # æå–æ ‡ç­¾
    # å­—å¹•è¯­è¨€ä¼˜å…ˆçº§è®¾ç½®
    preferred_subtitle_languages: ["zh-CN", "zh", "en"]  # ä¼˜å…ˆæ£€æµ‹çš„å­—å¹•è¯­è¨€
    subtitle_fallback_to_transcription: true             # æ— å­—å¹•æ—¶å›é€€åˆ°éŸ³é¢‘è½¬å½•
    quick_metadata_timeout: 8                            # å¿«é€Ÿå…ƒæ•°æ®è·å–è¶…æ—¶(ç§’)
    extract_comments: false      # æå–è¯„è®º(è€—æ—¶)
