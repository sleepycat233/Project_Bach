
paths:
  data_folder: "./data"  # 数据存储目录 (转录文本、日志等)
  watch_folder: "./data/uploads"  # 音频文件监控目录 - 直接监控上传目录
  output_folder: "./data/output"  # 处理结果输出目录

spacy:
  model: "zh_core_web_sm"

# 系统配置
system:
  debug: false  # 调试模式开关

logging:
  level: "INFO"  # 日志级别: DEBUG, INFO, WARNING, ERROR, CRITICAL
  file: "./data/logs/app.log"
  console: true  # 是否在控制台输出日志


# OpenRouter API配置 (用于AI内容生成)
# API key 通过环境变量 OPENROUTER_API_KEY 提供
openrouter:
  base_url: "https://openrouter.ai/api/v1"
  models:
    summary: "google/gemma-3n-e4b-it:free"  # Google免费快速模型
    mindmap: "google/gemma-3n-e4b-it:free"  # Google免费快速模型
    # 备选免费快速模型：

  rate_limit_tier: "paid"  # 选项: "free" 或 "paid"
  # Free tier: 10 req/10s, 60 req/min, 5 credits/day
  # Paid tier: 10 req/10s, 60 req/min, 按credit计费

# Phase 10: MLX Whisper配置 (替代WhisperKit)
mlx_whisper:
  # 默认模型配置 - 使用标准MLX命名
  default_model: "whisper-tiny-mlx"  # 默认使用的模型

  # 可用模型列表（统一使用标准MLX命名）
  available_models:
    - "mlx-community/whisper-tiny-mlx"
    - "mlx-community/whisper-base-mlx"
    - "mlx-community/whisper-small-mlx"
    - "mlx-community/whisper-medium-mlx"
    - "mlx-community/whisper-large-v3-mlx"
    - "mlx-community/whisper-large-v3-turbo"

# Speaker Diarization配置
diarization:
  provider: "pyannote"   # 使用pyannote-audio，从HuggingFace缓存加载
  max_speakers: 6
  min_segment_duration: 1.0

  # pyannote.audio pipeline参数配置 (严格参数，减少误检)
  # 基于Phase 11调试结果优化的严格配置
  pipeline_params:
    segmentation:
      min_duration_off: 1.0          # 最小静音时长(秒) - 更严格，减少短插话误检
    clustering:
      method: "centroid"             # 聚类方法
      min_cluster_size: 20           # 最小聚类大小 - 更大值，减少虚假说话人
      threshold: 0.9                 # 聚类阈值 - 更高值，降低敏感度

  # 输出格式配置
  output_format:
    group_by_speaker: true          # 默认按说话人分组，便于阅读
    timestamp_precision: 1          # 时间戳精度(小数位数)
    include_confidence: false       # 是否包含置信度信息


# Phase 6: 多媒体内容分类与Web界面配置
# content_classification:
#   # 使用代码中的DEFAULT_CONTENT_TYPES默认值
#   # 包含: lecture, meeting, youtube, others


# Phase 6: Web前端配置
web_frontend:
  # Flask应用配置
  # Flask密钥通过环境变量 FLASK_SECRET_KEY 提供
  app:
    host: "0.0.0.0"              # 监听地址 (Tailscale网络内)
    port: 8080                   # 服务端口
    debug: false                 # 调试模式

  # 文件上传配置
  upload:
    max_file_size: 1073741824    # 1GB (1024 * 1024 * 1024)
    supported_formats: [".mp3", ".wav", ".m4a", ".mp4", ".flac", ".aac", ".ogg", ".wma"]

  # 安全配置
  security:
    tailscale_only: true         # 仅允许Tailscale网络访问
    rate_limit_per_minute: 60    # 每分钟请求限制
    rate_limit_per_hour: 1000    # 每小时请求限制
    enable_csrf: true            # 启用CSRF保护
    session_timeout: 3600        # 会话超时(秒)

  # UI配置
  ui:
    theme: "dark"                # 默认主题
    language: "zh-CN"            # 默认语言

# GitHub Pages配置
# GitHub username和token通过环境变量 GITHUB_USERNAME 和 GITHUB_TOKEN 提供
github:
  repo_name: "Project_Bach"  # 仓库名称（可配置）
  pages:
    enabled: true           # 是否启用GitHub Pages链接
    # pages_url 将自动生成为: https://{username}.github.io/{repo_name}

# YouTube处理器配置
youtube:
  # yt-dlp配置
  downloader:
    max_duration: 7200           # 最大时长(秒) 2小时
    min_duration: 60             # 最小时长(秒) 1分钟
    preferred_quality: "best[height<=720]"  # 首选质量
    extract_audio_only: true     # 仅提取音频
    output_format: "mp3"         # 输出格式
    output_dir: "./temp/youtube" # 输出目录
    timeout: 600                 # 下载超时(秒)

  # 内容验证
  validation:
    check_availability: true     # 检查视频可用性
    validate_duration: true      # 验证时长
    skip_private: true           # 跳过私有视频
    skip_age_restricted: false   # 跳过年龄限制视频

  # 元数据提取
  metadata:
    extract_thumbnail: true      # 提取缩略图
    extract_description: true    # 提取描述
    extract_tags: true           # 提取标签
    # 字幕语言优先级设置
    preferred_subtitle_languages: ["zh-CN", "zh", "en"]  # 优先检测的字幕语言
    subtitle_fallback_to_transcription: true             # 无字幕时回退到音频转录
    quick_metadata_timeout: 8                            # 快速元数据获取超时(秒)
    extract_comments: false      # 提取评论(耗时)
