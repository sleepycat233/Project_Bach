api:
  openrouter:
    key: "${OPENROUTER_API_KEY}"  # ä»ç¯å¢ƒå˜é‡è¯»å–
    base_url: "https://openrouter.ai/api/v1"

  # HuggingFace APIé…ç½® (ç”¨äºSpeaker Diarization)
  huggingface:
    token: "${HUGGINGFACE_TOKEN}"  # ä»ç¯å¢ƒå˜é‡è¯»å–

    models:
      summary: "google/gemma-3n-e2b-it:free"  # Googleå…è´¹å¿«é€Ÿæ¨¡å‹
      mindmap: "google/gemma-3n-e2b-it:free"  # Googleå…è´¹å¿«é€Ÿæ¨¡å‹
      # å¤‡é€‰å…è´¹å¿«é€Ÿæ¨¡å‹ï¼š
      # "opengvlab/internvl3-2b:free"      # æœ€å¿« (379.88 t/s)
      # "google/gemini-2.5-flash-preview"  # å¿«é€Ÿ (140.85 t/s)
      # "qwen/qwen3-30b-a3b:free"          # ä¸­ç­‰ (83.19 t/s)
    rate_limits:
      free_tier:
        requests_per_10s: 10      # æ¯10ç§’æœ€å¤š10ä¸ªè¯·æ±‚
        requests_per_minute: 60   # æ¯åˆ†é’Ÿæœ€å¤š60ä¸ªè¯·æ±‚
        daily_credit_limit: 5     # å…è´¹å±‚æ¯æ—¥5ä¸ªcredits
      paid_tier:
        requests_per_10s: 10      # ä»˜è´¹è´¦æˆ·10ç§’é™åˆ¶ç›¸åŒ
        requests_per_minute: 60   # æ¯åˆ†é’Ÿé™åˆ¶ç›¸åŒ
        credit_to_requests_ratio: 100  # æ¯ä¸ªcreditå…è®¸100ä¸ªè¯·æ±‚/å¤©

paths:
  data_folder: "./data"  # æ•°æ®å­˜å‚¨ç›®å½• (è½¬å½•æ–‡æœ¬ã€æ—¥å¿—ç­‰)
  watch_folder: "./data/uploads"  # éŸ³é¢‘æ–‡ä»¶ç›‘æ§ç›®å½• - ç›´æ¥ç›‘æ§ä¸Šä¼ ç›®å½•
  output_folder: "./data/output"  # å¤„ç†ç»“æœè¾“å‡ºç›®å½•

spacy:
  model: "zh_core_web_sm"

# Phase 10: MLX Whisperé…ç½® (æ›¿ä»£WhisperKit)
mlx_whisper:
  # é»˜è®¤æ¨¡å‹é…ç½® - ä½¿ç”¨æ ‡å‡†MLXå‘½å
  default_model: "whisper-tiny-mlx"  # é»˜è®¤ä½¿ç”¨çš„æ¨¡å‹

  # å¯ç”¨æ¨¡å‹åˆ—è¡¨ï¼ˆç»Ÿä¸€ä½¿ç”¨æ ‡å‡†MLXå‘½åï¼‰
  available_models:
    - "mlx-community/whisper-tiny-mlx"
    - "mlx-community/whisper-base-mlx"
    - "mlx-community/whisper-small-mlx"
    - "mlx-community/whisper-medium-mlx"
    - "mlx-community/whisper-large-v3-mlx"
    - "mlx-community/whisper-large-v3-turbo"

  # ç»Ÿä¸€ä½¿ç”¨HuggingFaceç¼“å­˜ï¼Œä¸æ”¯æŒæœ¬åœ°ä¸‹è½½ï¼ˆæ›´å¥½çš„è·¨é¡¹ç›®å…±äº«ï¼‰

  # è½¬å½•å‚æ•°é…ç½®
  transcription:
    word_timestamps: true                         # è¯çº§æ—¶é—´æˆ³(åŸç”Ÿæ”¯æŒ)
    language_detection: "auto"                    # è‡ªåŠ¨è¯­è¨€æ£€æµ‹
    supported_languages: ["en", "zh", "ja", "ko", "de", "fr", "es", "it", "pt", "ru"]

# Speaker Diarizationé…ç½®
diarization:
  provider: "pyannote"   # ä½¿ç”¨pyannote-audio
  max_speakers: 6
  min_segment_duration: 1.0
  model_path: "./models/diarization"            # è¯´è¯äººåˆ†ç¦»æ¨¡å‹ç›®å½•

  # åŸºäºcontent typeå’Œsubcategoryçš„diarizationé…ç½®
  content_type_defaults:
    # ä¸»åˆ†ç±»é»˜è®¤è®¾ç½®
    lecture: false       # è®²åº§é€šå¸¸å•äººï¼Œé»˜è®¤ä¸å¯ç”¨
    meeting: true        # ä¼šè®®å¤šäººå¯¹è¯ï¼Œé»˜è®¤å¯ç”¨

    # Lectureå­åˆ†ç±»é…ç½® - ç”¨æˆ·å¯è‡ªå®šä¹‰
    lecture_subcategories:
      CS101: false          # CSè¯¾ç¨‹ï¼Œå•äººè®²æˆ
      seminar: true      # ç ”è®¨ä¼šï¼Œå¯èƒ½æœ‰è®¨è®ºç¯èŠ‚
      workshop: true     # å·¥ä½œåŠï¼Œå¯èƒ½æœ‰äº’åŠ¨

  # è¾“å‡ºæ ¼å¼é…ç½®
  output_format:
    group_by_speaker: true          # é»˜è®¤æŒ‰è¯´è¯äººåˆ†ç»„ï¼Œä¾¿äºé˜…è¯»
    timestamp_precision: 1          # æ—¶é—´æˆ³ç²¾åº¦(å°æ•°ä½æ•°)
    include_confidence: false       # æ˜¯å¦åŒ…å«ç½®ä¿¡åº¦ä¿¡æ¯

# Phase 6: å¤šåª’ä½“å†…å®¹åˆ†ç±»ä¸Webç•Œé¢é…ç½®
content_classification:
  # æ”¯æŒçš„å†…å®¹ç±»å‹å®šä¹‰
  content_types:
    lecture:      # ğŸ“ å­¦æœ¯è®²åº§
      icon: "ğŸ“"
      display_name: "Academic Lecture"
      subcategories:  # è¯¾ç¨‹å­åˆ†ç±»
        - "PHYS101"
        - "CS101"
        - "Seminar"
      recommendations:
        english:
          - "whisper-base-mlx"
          - "whisper-small-mlx"  # è‹±æ–‡å¿«é€Ÿæ¨¡å‹
        multilingual:
          - "whisper-large-v3-mlx"         # å¤šè¯­è¨€é«˜ç²¾åº¦

    meeting:      # ğŸ¢ ä¼šè®®å½•éŸ³
      icon: "ğŸ¢"
      display_name: "Meeting Recording (Limited support, requires ElevenLabs speaker diarization)"
      subcategories:  # ä¼šè®®å­åˆ†ç±»
        - "team_meeting"
        - "project_review"
        - "client_call"
        - "standup"
      recommendations:
        english:
          - "whisper-base-mlx"                     # MLXè‹±æ–‡å¤„ç†
        multilingual:
          - "whisper-large-v3-mlx"                 # MLXå¤šè¯­è¨€å¤„ç†

# ç³»ç»Ÿé…ç½®
system:
  debug: false  # è°ƒè¯•æ¨¡å¼å¼€å…³

logging:
  level: "INFO"  # æ—¥å¿—çº§åˆ«: DEBUG, INFO, WARNING, ERROR, CRITICAL
  file: "./data/logs/app.log"
  console: true  # æ˜¯å¦åœ¨æ§åˆ¶å°è¾“å‡ºæ—¥å¿—

# Phase 4: ç½‘ç»œé›†æˆé…ç½®
network:
  tailscale:
    auth_key: "${TAILSCALE_AUTH_KEY}"  # ä»ç¯å¢ƒå˜é‡è¯»å–
    machine_name: "project-bach"  # æœºå™¨åç§°
    network_name: "project-bach-network"  # ç½‘ç»œåç§°
    auto_connect: true  # è‡ªåŠ¨è¿æ¥
    timeout: 30  # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰

  file_transfer:
    remote_base_path: "/Users/remote/project_bach/watch_folder"  # è¿œç¨‹ç›‘æ§æ–‡ä»¶å¤¹è·¯å¾„
    local_base_path: "./watch_folder"  # æœ¬åœ°ç›‘æ§æ–‡ä»¶å¤¹è·¯å¾„
    chunk_size: 8192  # æ–‡ä»¶ä¼ è¾“å—å¤§å°ï¼ˆå­—èŠ‚ï¼‰
    timeout: 60  # ä¼ è¾“è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    retry_attempts: 3  # é‡è¯•æ¬¡æ•°
    verify_integrity: true  # æ˜¯å¦éªŒè¯æ–‡ä»¶å®Œæ•´æ€§
    max_file_size: 104857600  # æœ€å¤§æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆ100MBï¼‰

  security:
    allowed_networks: ["100.64.0.0/10"]  # Tailscale CGNATèŒƒå›´
    blocked_ips: []  # é˜»æ­¢çš„IPåœ°å€åˆ—è¡¨
    require_encryption: true  # æ˜¯å¦è¦æ±‚åŠ å¯†è¿æ¥
    max_connection_attempts: 3  # æœ€å¤§è¿æ¥å°è¯•æ¬¡æ•°
    connection_timeout: 10  # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    max_connections_per_minute: 60  # æ¯åˆ†é’Ÿæœ€å¤§è¿æ¥æ•°
    connection_window_seconds: 60  # è¿æ¥é¢‘ç‡ç»Ÿè®¡çª—å£ï¼ˆç§’ï¼‰

  monitoring:
    check_interval: 30  # ç½‘ç»œçŠ¶æ€æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
    timeout: 5  # pingè¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    max_retries: 3  # æœ€å¤§é‡è¯•æ¬¡æ•°
    target_hosts: []  # ç›‘æ§ç›®æ ‡ä¸»æœºåˆ—è¡¨ï¼Œå¯åŠ¨æ—¶è‡ªåŠ¨å‘ç°TailscaleèŠ‚ç‚¹
    alert_on_disconnect: true  # è¿æ¥æ–­å¼€æ—¶æ˜¯å¦å‘Šè­¦

  # å®‰å…¨æ–‡ä»¶æœåŠ¡å™¨é…ç½®
  secure_file_server:
    enabled: true  # æ˜¯å¦å¯ç”¨å®‰å…¨æ–‡ä»¶æœåŠ¡å™¨
    host: "0.0.0.0"  # ç›‘å¬åœ°å€ï¼Œ0.0.0.0è¡¨ç¤ºæ‰€æœ‰æ¥å£
    port: 8080  # æœåŠ¡ç«¯å£
    allowed_dirs:  # åªå…è®¸è®¿é—®è¿™äº›ç›®å½•
      - "./watch_folder"
      - "./output"
    auth_token: "${SECURE_FILE_SERVER_TOKEN}"  # ä»ç¯å¢ƒå˜é‡è¯»å–
    enable_upload: true  # æ˜¯å¦å…è®¸æ–‡ä»¶ä¸Šä¼ 
    enable_download: true  # æ˜¯å¦å…è®¸æ–‡ä»¶ä¸‹è½½

# Phase 5: GitHub Pages è‡ªåŠ¨å‘å¸ƒé…ç½®
github:
  # GitHubä»“åº“ä¿¡æ¯
  username: "${GITHUB_USERNAME}"  # ä½ çš„GitHubç”¨æˆ·åï¼ˆä»ç¯å¢ƒå˜é‡è¯»å–ï¼‰
  repo_name: "Project_Bach"  # ä»“åº“å
  pages_branch: "gh-pages"  # GitHub Pageséƒ¨ç½²åˆ†æ”¯

  # APIè®¿é—®é…ç½® (ç”¨äºæŸ¥è¯¢ä»“åº“çŠ¶æ€ç­‰)
  token: "${GITHUB_TOKEN}"  # GitHub Personal Access Token (ä»ç¯å¢ƒå˜é‡è¯»å–)

  # Gité…ç½® (ä½¿ç”¨SSHè®¤è¯ï¼Œæ— éœ€token)
  remote_url: "git@github.com:${GITHUB_USERNAME}/Project_Bach.git"  # SSHè¿œç¨‹åœ°å€

  # Gitç”¨æˆ·é…ç½® (å¦‚æœç³»ç»Ÿæ²¡æœ‰å…¨å±€é…ç½®æ—¶ä½¿ç”¨çš„é»˜è®¤å€¼)
  default_user_name: "Project Bach Bot"  # é»˜è®¤ç”¨æˆ·å
  default_user_email: "bot@project-bach.com"  # é»˜è®¤é‚®ç®±

  # ç½‘ç«™é…ç½®
  website:
    title: "Project Bach"
    description: "åŸºäº MLX Whisper + OpenRouter + spaCy çš„æ™ºèƒ½éŸ³é¢‘å¤„ç†ä¸å†…å®¹ç”Ÿæˆç³»ç»Ÿ"
    theme: "dark"  # é»˜è®¤ä¸»é¢˜: light, dark, auto

  # éƒ¨ç½²è®¾ç½®
  publishing:
    auto_deploy: true  # æ˜¯å¦è‡ªåŠ¨éƒ¨ç½²åˆ°GitHub Pages
    include_source: false  # ç½‘ç«™åˆ†æ”¯æ˜¯å¦åŒ…å«æºä»£ç  (æ¨è: false)
    clean_deploy: true  # æ¯æ¬¡éƒ¨ç½²å‰æ¸…ç†ç½‘ç«™åˆ†æ”¯ (æ¨è: true)
    max_files_per_deploy: 50  # æ¯æ¬¡éƒ¨ç½²æœ€å¤šåŒ…å«çš„éŸ³é¢‘ç»“æœæ–‡ä»¶æ•°

  # å†…å®¹è¿‡æ»¤
  content_filter:
    exclude_patterns:  # ä¸å‘å¸ƒåŒ…å«è¿™äº›æ¨¡å¼çš„æ–‡ä»¶
      - "*private*"
      - "*confidential*"
      - "*test*"
    min_content_length: 100  # æœ€å°å†…å®¹é•¿åº¦ (å­—ç¬¦)
    anonymize_names: true  # æ˜¯å¦åœ¨å‘å¸ƒå‰è¿›è¡ŒäººååŒ¿ååŒ–

# æ¨¡æ¿é…ç½®
templates:
  base_dir: "./templates"  # æ¨¡æ¿æ–‡ä»¶ç›®å½•

  # é¡µé¢æ¨¡æ¿
  homepage: "index.html.j2"  # ä¸»é¡µæ¨¡æ¿
  content: "content.html.j2"  # å†…å®¹é¡µé¢æ¨¡æ¿
  error: "error.html.j2"  # é”™è¯¯é¡µé¢æ¨¡æ¿

  # æ ·å¼é…ç½®
  css:
    primary_color: "#0066cc"  # ä¸»è‰²è°ƒ
    dark_primary_color: "#4fc3f7"  # æ·±è‰²æ¨¡å¼ä¸»è‰²è°ƒ
    font_family: "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif"

  # åŠŸèƒ½å¼€å…³
  features:
    theme_toggle: true  # ä¸»é¢˜åˆ‡æ¢æŒ‰é’®
    search: false  # æœç´¢åŠŸèƒ½ (æœªæ¥åŠŸèƒ½)
    rss_feed: false  # RSSè®¢é˜… (æœªæ¥åŠŸèƒ½)
    comments: false  # è¯„è®ºç³»ç»Ÿ (æœªæ¥åŠŸèƒ½)
  # åˆ†ç±»ç®—æ³•é…ç½®
  classification:
    confidence_threshold: 0.5        # åˆ†ç±»ç½®ä¿¡åº¦é˜ˆå€¼
    max_content_length: 5000         # å†…å®¹åˆ†ææœ€å¤§é•¿åº¦
    enable_auto_tagging: true        # å¯ç”¨è‡ªåŠ¨æ ‡ç­¾æå–
    default_category: "lecture"      # é»˜è®¤åˆ†ç±»
    enable_manual_override: true     # å…è®¸æ‰‹åŠ¨è¦†ç›–åˆ†ç±»

    # æƒé‡é…ç½® (ä¼˜å…ˆçº§: URL > æ–‡ä»¶å > å†…å®¹)
    scoring_weights:
      url_match: 0.6      # URLæ¨¡å¼åŒ¹é…æƒé‡
      filename_match: 0.3 # æ–‡ä»¶åæ¨¡å¼åŒ¹é…æƒé‡
      content_match: 0.1  # å†…å®¹åˆ†ææƒé‡

    # æ ‡ç­¾æå–é…ç½®
    tag_extraction:
      max_tags: 10                    # æœ€å¤§æ ‡ç­¾æ•°é‡
      min_tag_length: 2               # æœ€å°æ ‡ç­¾é•¿åº¦
      exclude_common_words: true      # æ’é™¤å¸¸è§è¯æ±‡
      include_technical_terms: true   # åŒ…å«æŠ€æœ¯æœ¯è¯­

  # å†…å®¹è¿‡æ»¤é…ç½®
  content_filter:
    exclude_patterns:     # æ’é™¤æ¨¡å¼
      - "advertisement"
      - "sponsored"
      - "ad-block"
      - "promotion"
      - "å¹¿å‘Š"
      - "æ¨å¹¿"
    include_patterns:     # åŒ…å«æ¨¡å¼ (ä¼˜å…ˆçº§é«˜äºæ’é™¤)
      - "technology"
      - "research"
      - "education"
      - "tutorial"
      - "æŠ€æœ¯"
      - "ç ”ç©¶"
      - "æ•™è‚²"
      - "æ•™ç¨‹"
    min_quality_score: 0.5  # æœ€å°è´¨é‡åˆ†æ•°

  # æ¨¡å‹æ¨èç­–ç•¥å·²ç§»è‡³å„content_typeä¸‹çš„model_recommendationsé…ç½®

# Phase 6: Webå‰ç«¯é…ç½®
web_frontend:
  # Flaskåº”ç”¨é…ç½®
  app:
    host: "0.0.0.0"              # ç›‘å¬åœ°å€ (Tailscaleç½‘ç»œå†…)
    port: 8080                   # æœåŠ¡ç«¯å£
    debug: false                 # è°ƒè¯•æ¨¡å¼
    secret_key_env: "FLASK_SECRET_KEY"  # ä»ç¯å¢ƒå˜é‡è¯»å–å¯†é’¥

  # æ–‡ä»¶ä¸Šä¼ é…ç½®
  upload:
    max_file_size: 104857600     # 100MB
    allowed_extensions: [".mp3", ".wav", ".m4a", ".mp4", ".flac", ".aac", ".ogg"]
    upload_folder: "./uploads"   # ä¸Šä¼ ç›®å½•ï¼Œä¹Ÿæ˜¯æ–‡ä»¶ç›‘æ§ç›®å½•
    temp_folder: "./temp"
    auto_cleanup: true           # è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    cleanup_interval: 3600       # æ¸…ç†é—´éš”(ç§’)
    # æ–‡ä»¶ç»„ç»‡é…ç½®
    organize_by_category: true   # å¯ç”¨æŒ‰åˆ†ç±»ç»„ç»‡æ–‡ä»¶
    create_subcategory_folders: true  # ä¸ºsubcategoryåˆ›å»ºå­æ–‡ä»¶å¤¹

  # å®‰å…¨é…ç½®
  security:
    tailscale_only: true         # ä»…å…è®¸Tailscaleç½‘ç»œè®¿é—®
    rate_limit_per_minute: 60    # æ¯åˆ†é’Ÿè¯·æ±‚é™åˆ¶
    rate_limit_per_hour: 1000    # æ¯å°æ—¶è¯·æ±‚é™åˆ¶
    enable_csrf: true            # å¯ç”¨CSRFä¿æŠ¤
    session_timeout: 3600        # ä¼šè¯è¶…æ—¶(ç§’)

  # UIé…ç½®
  ui:
    theme: "dark"                # é»˜è®¤ä¸»é¢˜
    language: "zh-CN"            # é»˜è®¤è¯­è¨€
    show_progress: true          # æ˜¾ç¤ºå¤„ç†è¿›åº¦
    auto_refresh_interval: 5     # çŠ¶æ€è‡ªåŠ¨åˆ·æ–°é—´éš”(ç§’)
    max_concurrent_uploads: 3    # æœ€å¤§å¹¶å‘ä¸Šä¼ æ•°

# YouTubeå¤„ç†å™¨é…ç½®
youtube:
  # yt-dlpé…ç½®
  downloader:
    max_duration: 7200           # æœ€å¤§æ—¶é•¿(ç§’) 2å°æ—¶
    min_duration: 60             # æœ€å°æ—¶é•¿(ç§’) 1åˆ†é’Ÿ
    preferred_quality: "best[height<=720]"  # é¦–é€‰è´¨é‡
    extract_audio_only: true     # ä»…æå–éŸ³é¢‘
    output_format: "mp3"         # è¾“å‡ºæ ¼å¼
    output_dir: "./temp/youtube" # è¾“å‡ºç›®å½•
    timeout: 600                 # ä¸‹è½½è¶…æ—¶(ç§’)

  # å†…å®¹éªŒè¯
  validation:
    check_availability: true     # æ£€æŸ¥è§†é¢‘å¯ç”¨æ€§
    validate_duration: true      # éªŒè¯æ—¶é•¿
    skip_private: true           # è·³è¿‡ç§æœ‰è§†é¢‘
    skip_age_restricted: false   # è·³è¿‡å¹´é¾„é™åˆ¶è§†é¢‘

  # å…ƒæ•°æ®æå–
  metadata:
    extract_thumbnail: true      # æå–ç¼©ç•¥å›¾
    extract_description: true    # æå–æè¿°
    extract_tags: true           # æå–æ ‡ç­¾
    # å­—å¹•è¯­è¨€ä¼˜å…ˆçº§è®¾ç½®
    preferred_subtitle_languages: ["zh-CN", "zh", "en"]  # ä¼˜å…ˆæ£€æµ‹çš„å­—å¹•è¯­è¨€
    subtitle_fallback_to_transcription: true             # æ— å­—å¹•æ—¶å›é€€åˆ°éŸ³é¢‘è½¬å½•
    quick_metadata_timeout: 8                            # å¿«é€Ÿå…ƒæ•°æ®è·å–è¶…æ—¶(ç§’)
    extract_comments: false      # æå–è¯„è®º(è€—æ—¶)

# RSSå¤„ç†å™¨é…ç½®
rss:
  # è®¢é˜…ç®¡ç†
  subscriptions:
    max_subscriptions: 50        # æœ€å¤§è®¢é˜…æ•°
    default_refresh_interval: 3600  # é»˜è®¤åˆ·æ–°é—´éš”(ç§’)
    auto_refresh: true           # è‡ªåŠ¨åˆ·æ–°
    storage_file: "./data/rss_subscriptions.json"  # è®¢é˜…å­˜å‚¨æ–‡ä»¶

  # å†…å®¹å¤„ç†
  processing:
    max_articles_per_feed: 20    # æ¯ä¸ªfeedæœ€å¤§æ–‡ç« æ•°
    content_length_min: 500      # æœ€å°å†…å®¹é•¿åº¦
    content_length_max: 50000    # æœ€å¤§å†…å®¹é•¿åº¦
    enable_summarization: true   # å¯ç”¨AIæ‘˜è¦
    preserve_html: false         # ä¿ç•™HTMLæ ¼å¼

  # è¿‡æ»¤é…ç½®
  filtering:
    exclude_duplicates: true     # æ’é™¤é‡å¤æ–‡ç« 
    exclude_old_articles: true   # æ’é™¤æ—§æ–‡ç« 
    max_age_days: 30            # æœ€å¤§æ–‡ç« å¹´é¾„(å¤©)
    spam_detection: true         # åƒåœ¾æ£€æµ‹

  # ç½‘ç»œé…ç½®
  network:
    timeout: 30                  # è¯·æ±‚è¶…æ—¶(ç§’)
    max_retries: 3              # æœ€å¤§é‡è¯•æ¬¡æ•°
    user_agent: "Project Bach RSS Reader 1.0"